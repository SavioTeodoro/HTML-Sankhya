<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="UTF-8" isELIgnored="false" %>
	<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
	<%@ page import="java.util.*" %>
		<%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" %>
			<%@ taglib prefix="snk" uri="/WEB-INF/tld/sankhyaUtil.tld" %>
            <%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
				<html>      
				<head>
					<title>HTML5 Component</title>
					<link rel="stylesheet" type="text/css" href="mainCSS.css">
					<snk:load />
					<script type='text/javascript'>
						function abrirFinanceiros(codNat) {
							var params = { 'A_CODNAT': codNat };
							openLevel('lvl_a6616yv', params);
						}
					</script>
								</head>

				<body>
					<h2>DRE - CAIXA</h2>
					<snk:query var="teste">
                        WITH DADOS AS (
                            SELECT
                                Z.*,
                         CASE
                                    WHEN ORDEM IN (1, 3, 5, 6, 8, 9, 11, 13, 15, 16, 18, 19) THEN '#2A7344'
                                END AS BKCOLOR,
                         CASE
                                    WHEN ORDEM IN (1, 3, 5, 6, 8, 9, 11, 13, 15, 16, 18, 19) THEN '#ffffff'
                                END AS FGCOLOR
                            FROM
                                (
                                    SELECT
                                        
                                        10000 AS CODNAT,
                                        ' CONTA BANCARIA SALDO INICIAL' AS DESCRNAT,
                                        0 AS ORDEM,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 01 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS JANEIRO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 02 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS FEVEREIRO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 03 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS MARCO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 04 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS ABRIL,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 05 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS MAIO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 06 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS JUNHO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 07 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS JULHO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 08 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS AGOSTO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 09 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS SETEMBRO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 10 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS OUTUBRO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 11 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS NOVEMBRO,
                                        SUM(CASE
                                                WHEN TO_CHAR(SBC.REFERENCIA, 'MM') = 12 THEN (SBC.SALDOREAL)    ELSE 0
                                            END
                                        ) AS DEZEMBRO,
                                        SUM((0)) AS TOTAL
                                    FROM
                                        TGFSBC SBC
                                        INNER JOIN TSICTA CTA ON CTA.CODCTABCOINT = SBC.CODCTABCOINT
                                    WHERE
                                        SBC.REFERENCIA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND CTA.CODEMP IN (:EMPRESA)
                                        AND CTA.CODCTABCOINT IN (:CODBCO)
                                    UNION
                                    ALL
                                    SELECT
                                        90101000 AS CODNAT,
                                        ' RECEITA OPERACIONAL' AS DESCRNAT,
                                        1 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9010)
                                        AND SUBSTR(FIN.CODNAT, 1, 6) NOT IN(901020)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                    UNION
                                    ALL
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        2 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9010)
                                        AND SUBSTR(FIN.CODNAT, 1, 6) NOT IN(901020)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    SELECT
                                        9010,
                                        '( = ) RECEITA LÍQUIDA',
                                        5 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN (9010)
                                    UNION
                                    ALL
                                    /* SUBTOTAL DE RECEITAS (-) CUSTOS (MARGEM BRUTA) */
                                    SELECT
                                        90102000 AS CODNAT,
                                        ' DEDUÇÕES DA RECEITA' AS DESCRNAT,
                                        3 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND SUBSTR(FIN.CODNAT, 1, 6) IN (901020)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                    UNION
                                    ALL
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        4 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 6) IN (901020)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    SELECT
                                        902030 AS CODNAT,
                                        ' CUSTO DE MERCADORIA' AS DESCRNAT,
                                        6 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9020)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                    UNION
                                    ALL
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        7 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9020)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    SELECT
                                        902030,
                                        '( = ) MARGEM BRUTA',
                                        8 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN (9010, 9020)
                                    UNION
                                    ALL
                                    /* TOTALIZADOR TITULO: DESPESAS OPERACIONAIS - GRUPO
                                     12/13 NATUREZA */
                                    SELECT
                                        9030,
                                        'DESPESA OPERACIONAL',
                                        9 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9030)
                                    UNION
                                    ALL
                                    /* DETALHAMENTO DESPESAS */
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        10 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9030)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    /* SUBTOTAL DE RECEITAS - CUSTO - DESPESA */
                                    SELECT
                                        9030,
                                        '( = ) RESULTADO OPERACIONAL ',
                                        11 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN (9010, 9020, 9030)
                                    UNION
                                    ALL
                                    /* OUTROS GRUPOS */
                                    SELECT
                                        9040,
                                        'DESPESA/ RECEITAS FINANCEIRAS',
                                        12 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9040)
                                    UNION
                                    ALL
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        13 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9040)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    SELECT
                                        9050,
                                        'INVESTIMENTOS',
                                        14 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9050)
                                    UNION
                                    ALL
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        15 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9050)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    SELECT
                                        9070,
                                        'DESPESAS DIVERSAS',
                                        16 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9070, 9080, 9090)
                                    UNION
                                    ALL
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        17 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9070, 9080, 9090)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    /* TOTAL GERAL*/
                                    SELECT
                                        10000000,
                                        '( = ) RESULTADO LIQUIDO',
                                        18 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN (9010, 9020, 9030, 9040, 9050, 9070, 9080, 9090)
                                    UNION
                                    ALL
                                    SELECT
                                        9040,
                                        'DISTRIBUIÇÃO DE LUCROS',
                                        19 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9060)
                                    
                                    UNION            ALL
                                    
                                    SELECT
                                        PAI.CODNAT,
                                        PAI.DESCRNAT,
                                        20 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 4) IN(9060)
                                    GROUP BY
                                        PAI.CODNAT,
                                        PAI.DESCRNAT
                                    UNION
                                    ALL
                                    SELECT
                                        10000000,
                                        '( = )RESULTADO LIQUIDO APÓS DISTRIBUIÇÃO DE LUCROS',
                                        21 AS ORDEM,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 01 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JANEIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 02 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS FEVEREIRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 03 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MARCO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 04 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS ABRIL,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 05 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS MAIO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 06 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JUNHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 07 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS JULHO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 08 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS AGOSTO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 09 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ) ,0)AS SETEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 10 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS OUTUBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 11 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS NOVEMBRO,
                                        NVL(SUM(CASE
                                                WHEN TO_CHAR(FIN.DHBAIXA, 'MM') = 12 THEN (FIN.VLRBAIXA * FIN.RECDESP)    ELSE 0
                                            END
                                        ),0) AS DEZEMBRO,
                                        NVL(SUM((FIN.VLRBAIXA * FIN.RECDESP)),0) AS TOTAL
                                    FROM
                                        TGFFIN FIN
                                        INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC
                                        INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT
                                        LEFT JOIN TGFNAT PAI ON PAI.CODNAT = NAT.CODNATPAI
                                        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI
                                    WHERE
                                        FIN.DHBAIXA BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND FIN.PROVISAO <> 'S'
                                        AND FIN.CODCENCUS IN (:CODCENCUS)
                                        AND FIN.CODEMP IN (:EMPRESA)
                                        AND FIN.CODCTABCOINT IN (:CODBCO)
                                        AND SUBSTR(FIN.CODNAT, 1, 2) IN (90)
                                    UNION
                                    ALL
                                    SELECT
                                        10000 AS CODNAT,
                                        ' TRANSFERENCIA BANCARIA/ APLICAÇÃO' AS DESCRNAT,
                                        22 AS ORDEM,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 01 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS JANEIRO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 02 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS FEVEREIRO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 03 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS MARCO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 04 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS ABRIL,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 05 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS MAIO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 06 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS JUNHO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 07 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS JULHO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 08 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS AGOSTO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 09 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS SETEMBRO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 10 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS OUTUBRO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 11 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS NOVEMBRO,
                                        SUM(CASE WHEN TO_CHAR(DTLANC, 'MM') = 12 THEN (VLRLANC) * (CASE WHEN CODLANC = 2 THEN -1 ELSE 1 END)ELSE 0 END) AS DEZEMBRO,
                                        SUM((0)) AS TOTAL
                                    FROM
                                        TGFMBC
                                    WHERE
                                        CODCTABCOINT IN (:CODBCO)
                                        AND DTLANC BETWEEN :PERIODO.INI
                                        AND :PERIODO.FIN
                                        AND ORIGMOV IN ('T', 'A')
                                ) Z
                            ORDER BY
                                ORDEM, CODNAT
                        )
                        SELECT
                            CODNAT,
                            DESCRNAT,
                            ORDEM,
                            JANEIRO,
                            FEVEREIRO,
                            MARCO,
                            ABRIL,
                            MAIO,
                            JUNHO,
                            JULHO,
                            AGOSTO,
                            SETEMBRO,
                            OUTUBRO,
                            NOVEMBRO,
                            DEZEMBRO,
                            FGCOLOR,
                            BKCOLOR
                        FROM
                            DADOS D
					</snk:query>

					<table class="styled-table">
						<tbody>
						<tr>
							<th>Descrição Natureza</th>
							<th>Janeiro</th>
							<th>Fevereiro</th>
							<th>Março</th>
							<th>Abril</th>
							<th>Maio</th>
							<th>Junho</th>
							<th>Julho</th>
							<th>Agosto</th>
							<th>Setembro</th>
							<th>Outubro</th>
							<th>Novembro</th>
							<th>Dezembro</th>
						</tr>
						<c:forEach items="${teste.rows}" var="row">
							<tr class="active-row">
								<td>
									<a href="javascript:abrirFinanceiros(${row.CODNAT})"><c:out value="${row.DESCRNAT}" /></a>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.JANEIRO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.FEVEREIRO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.MARCO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.ABRIL}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.MAIO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.JUNHO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.JULHO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.AGOSTO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.SETEMBRO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.OUTUBRO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.NOVEMBRO}" type="currency"/>
								</td>
								<td class="column100">
									<fmt:formatNumber value ="${row.DEZEMBRO}" type="currency"/>
								</td>
							</tr>
						</c:forEach>
					</tbody>
					</table>
				</body>
				</html>

<style>
  .styled-table {
	border-collapse: collapse;
    margin: auto;
    border: 1px solid;
    border-color: #424242;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.377);
    padding: auto;
}

.styled-table tbody tr {
    border-bottom: 1px solid #dddddd;
}
.styled-table th,
.styled-table td {
white-space: nowrap;
}
tr:hover{
    background-color: #f2f2f2;
}

td{
    margin:  5px 20px;
    padding:  5px 20px;
}

a:hover {
  color: black;
  font-size: 1em;
  transition: 0.9s;
  cursor: pointer;
}

a:active {
  color: #67b588;
}

.styled-table tbody tr {
    font-weight: bold;
    color: #4c3a5e;
}

a {
  text-decoration: none;
  color: #4c3a5e;
}


h2{
	text-align: center;
	size: 20px;
    font-family: "Raleway", sans-serif;
}

.column100{
	text-align: right;

}

tbody tr.active-row:nth-of-type(2){
  background-color: #91c68d;
  color: #4c3a5e;
}

tbody tr.active-row:nth-of-type(3){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(6){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(8){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(9){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(14){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(15){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(24){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(25){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(28){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(31){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(33){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(34){
  background-color: #91c68d;
  color: #4c3a5e;
}
tbody tr.active-row:nth-of-type(36){
  background-color: #91c68d;
  color: #4c3a5e;
}

</style>
